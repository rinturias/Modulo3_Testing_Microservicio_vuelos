{
	"info": {
		"_postman_id": "3ae3ce7a-e671-46a8-8988-d5ddb3340ba8",
		"name": "Microservicio Vuelos",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "5868873"
	},
	"item": [
		{
			"name": "Crear vuelo",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let vuelos=pm.environment.get('vuelo');\r",
							"  //vuelos=[];\r",
							"if( !vuelos || vuelos.length == 0){\r",
							"console.log(\"entra a crear primero vuelos\");\r",
							"vuelos =[\r",
							"{\r",
							"  \"detalle\": {\r",
							"    \"horaSalida\": \"2022-05-27T00:39:29.914Z\",\r",
							"    \"horaLLegada\": \"2022-05-27T00:39:29.914Z\",\r",
							"    \"estado\": \"A\",\r",
							"    \"precio\": 200,\r",
							"    \"stockAsientos\": 10,\r",
							"    \"fecha\": \"2022-05-27T00:39:29.914Z\",\r",
							"    \"codDestino\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"    \"codOrigen\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"    \"codAeronave\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"    \"activo\": 0,\r",
							"    \"tripulaciones\": [\r",
							"      {\r",
							"        \"codVuelo\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"        \"codTripulacion\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"        \"codEmpleado\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"        \"estado\": \"A\",\r",
							"        \"activo\": 0\r",
							"      }\r",
							"    ]\r",
							"  }\r",
							"},\r",
							"{\r",
							"  \"detalle\": {\r",
							"    \"horaSalida\": \"2022-07-27T18:33:57.614Z\",\r",
							"    \"horaLLegada\": \"2022-07-27T18:33:57.614Z\",\r",
							"    \"estado\": \"A\",\r",
							"    \"precio\": 100,\r",
							"    \"stockAsientos\": 5,\r",
							"    \"fecha\": \"2022-07-27T18:33:57.614Z\",\r",
							"    \"codDestino\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"    \"codOrigen\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"    \"codAeronave\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"    \"activo\": 0,\r",
							"    \"tripulaciones\": [\r",
							"      {\r",
							"        \"codVuelo\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"        \"codTripulacion\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"        \"codEmpleado\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r",
							"        \"estado\": \"A\",\r",
							"        \"activo\": 0\r",
							"      }\r",
							"    ]\r",
							"  }\r",
							"}\r",
							"\r",
							"];\r",
							"\r",
							"}\r",
							"// else{\r",
							"//     console.log(\"esta creado vuelos\");\r",
							"  \r",
							"// }\r",
							"\r",
							"let currentVuelos=vuelos.shift();\r",
							"//pm.environment.set('currentVuelo',currentVuelos);\r",
							"pm.environment.set('cpHoraSalida',currentVuelos.detalle.horaSalida);\r",
							"pm.environment.set('cpHoraLLegada',currentVuelos.detalle.horaLLegada);\r",
							"pm.environment.set('cpEstado',currentVuelos.detalle.estado);\r",
							"pm.environment.set('cpPrecio',currentVuelos.detalle.precio);\r",
							"pm.environment.set('cpStockAsientos',currentVuelos.detalle.stockAsientos);\r",
							"pm.environment.set('cpFecha',currentVuelos.detalle.fecha);\r",
							"pm.environment.set('cpCodDestino',currentVuelos.detalle.codDestino);\r",
							"pm.environment.set('cpCodOrigen',currentVuelos.detalle.codOrigen);\r",
							"pm.environment.set('cpCodAeronave',currentVuelos.detalle.codAeronave);\r",
							"pm.environment.set('cpActivo',currentVuelos.detalle.activo);\r",
							"pm.environment.set('vuelo',vuelos);\r",
							"\r",
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"let vuelos=pm.environment.get('vuelo');\r",
							"\r",
							"console.log(\"VUELOS:\"+vuelos.length);\r",
							"if(vuelos && vuelos.length > 0){\r",
							"    console.log(\"crear vuelo\");\r",
							"    postman.setNextRequest(\"Crear vuelo\");\r",
							"}\r",
							"else{\r",
							"     console.log(\"Null crear vuelo\");\r",
							"   postman.setNextRequest(\"Crear vuelo\");\r",
							"}\r",
							"\r",
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"    var jsonData = pm.response.json();\r",
							"    pm.environment.set(\"vuelo_id\", jsonData.data);\r",
							"});\r",
							"\r",
							"pm.test(\"Body matches empty\", function () {\r",
							"    pm.expect(pm.response.json()).not.empty;\r",
							"});\r",
							"pm.test(\"codigo de estado success de la aplicacion\", function () {\r",
							"    var jsonData = pm.response.json();\r",
							"    console.log(jsonData);\r",
							"    pm.expect(jsonData.success).to.eql(true);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"detalle\": {\r\n    \"horaSalida\":   \"{{cpHoraSalida}}\",\r\n    \"horaLLegada\": \"{{cpHoraLLegada}}\",\r\n    \"estado\": \"{{cpEstado}}\",\r\n    \"precio\": {{cpPrecio}},\r\n    \"stockAsientos\": {{cpStockAsientos}},\r\n    \"fecha\": \"{{cpFecha}}\",\r\n    \"codDestino\": \"{{cpCodDestino}}\",\r\n    \"codOrigen\": \"{{cpCodOrigen}}\",\r\n    \"codAeronave\": \"{{cpCodAeronave}}\",\r\n    \"activo\": {{cpActivo}},\r\n    \"tripulaciones\": [\r\n      {\r\n        \"codVuelo\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r\n        \"codTripulacion\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r\n        \"codEmpleado\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r\n        \"estado\": \"A\",\r\n        \"activo\": 0\r\n      }\r\n    ]\r\n  }\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://localhost:44324/api/Vuelo/CreateVuelo",
					"protocol": "https",
					"host": [
						"localhost"
					],
					"port": "44324",
					"path": [
						"api",
						"Vuelo",
						"CreateVuelo"
					]
				}
			},
			"response": []
		},
		{
			"name": "Listar planilla de asientos por vuelo",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"\r",
							"pm.test(\"codigo de estado success de la aplicacion\", function () {\r",
							"    var jsonData = pm.response.json();\r",
							"    console.log(jsonData);\r",
							"    pm.expect(jsonData.success).to.eql(true);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"searchVuelosDTO\": {\r\n    \"fecInicial\": \"2022-05-28T10:42:35.319Z\",\r\n    \"fecFinal\": \"2022-05-28T10:42:35.319Z\",\r\n    \"codVuelo\": \"{{vuelo_id}}\"\r\n  }\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://localhost:44324/api/Vuelo/SearchPlanillaAsientosVuelosByDay",
					"protocol": "https",
					"host": [
						"localhost"
					],
					"port": "44324",
					"path": [
						"api",
						"Vuelo",
						"SearchPlanillaAsientosVuelosByDay"
					]
				}
			},
			"response": []
		}
	]
}